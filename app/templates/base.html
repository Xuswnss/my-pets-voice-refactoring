<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% block title %} {% endblock %}</title>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
        <!-- <link rel="icon" href="/favicon.ico" type=""> -->
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            primary: {
                                50: '#fefce8',
                                100: '#fef9c3',
                                200: '#fef08a',
                                300: '#fde047',
                                400: '#facc15',
                                500: '#eab308',
                                600: '#ca8a04',
                                700: '#a16207',
                                800: '#854d0e',
                                900: '#713f12',
                            },
                            secondary: {
                                50: '#fff7ed',
                                100: '#ffedd5',
                                200: '#fed7aa',
                                300: '#fdba74',
                                400: '#fb923c',
                                500: '#f97316',
                                600: '#ea580c',
                                700: '#c2410c',
                                800: '#9a3412',
                                900: '#7c2d12',
                            }
                        },
                        fontFamily: {
                            'korean': ['Noto Sans KR', 'sans-serif']
                        }
                    }
                }
            }
        </script>

        <style>
            .nav-active {
                background: linear-gradient(135deg, #ff6b6b, #ffa500) !important;
            }
            .nav-hover:hover {
                background: linear-gradient(135deg, #ff6b6b, #ffa500) !important;
            }
            
            /* 모바일에서 네비게이션 최소 너비 보장 */
            @media (max-width: 768px) {
                .max-w-20 {
                    max-width: 5rem; /* 20 * 0.25rem = 5rem */
                }
                
                /* 네비게이션 바 최소 너비 설정 */
                nav > div {
                    min-width: 320px; /* 최소 320px 보장 */
                }
            }
        </style>


        <script src="{{ url_for('static', filename='js/base.js', v=static_version) }}" defer></script>

    </head>
    <body class="font-korean text-gray-800 min-h-screen bg-white">
        <!-- 네비게이션 -->
        <nav class="bg-white shadow-sm sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-5 flex justify-between items-center h-20">
                <!-- 좌측: 로고 -->
                <a href="/" class="flex items-center text-secondary-500 hover:text-secondary-600 transition-colors flex-shrink-0">
                    <div class="flex items-center text-xl md:text-2xl font-bold">
                        <img src="{{ url_for('static', filename='img/my_pet_voice.PNG', v=static_version) }}" 
                             class="w-12 md:w-16 mr-2 md:mr-3 flex-shrink-0" alt="My Pet's Voice Logo">
                        <span class="truncate">My Pet's Voice</span>
                    </div>
                </a>
                
                <!-- 중앙: 데스크톱 메뉴 -->
                <div class="hidden md:flex space-x-4">
                    <a href="{{ url_for('chat.chat_views.chat')}}" class="px-3 py-2 rounded-lg {% if request.endpoint == 'chat.chat_views.chat' %}text-white{% else %}text-gray-700 hover:text-white{% endif %} transition-all duration-300 font-medium {% if request.endpoint == 'chat.chat_views.chat' %}nav-active{% else %}nav-hover{% endif %}">반려동물과 대화하기</a>
                    <a href="{{ url_for('diary.diary_views.diary')}}" class="px-3 py-2 rounded-lg {% if request.endpoint == 'diary.diary_views.diary' %}text-white{% else %}text-gray-700 hover:text-white{% endif %} transition-all duration-300 font-medium {% if request.endpoint == 'diary.diary_views.diary' %}nav-active{% else %}nav-hover{% endif %}">너의 일기장</a>
                    <a href="{{ url_for('dailycare.dailycare_views.get_dailycare')}}" class="px-3 py-2 rounded-lg {% if request.endpoint == 'dailycare.dailycare_views.get_dailycare' %}text-white{% else %}text-gray-700 hover:text-white{% endif %} transition-all duration-300 font-medium {% if request.endpoint == 'dailycare.dailycare_views.get_dailycare' %}nav-active{% else %}nav-hover{% endif %}">데일리 케어</a>
                    <a href="{{ url_for('mypage.mypage_views.mypage')}}" class="px-3 py-2 rounded-lg {% if request.endpoint == 'mypage.mypage_views.mypage' %}text-white{% else %}text-gray-700 hover:text-white{% endif %} transition-all duration-300 font-medium {% if request.endpoint == 'mypage.mypage_views.mypage' %}nav-active{% else %}nav-hover{% endif %}">마이페이지</a>
                </div>
                
                <!-- 모바일 메뉴 -->
                <div id="nav-menu" class="hidden md:hidden"></div>
                
                <!-- 우측: 날씨 + 사용자 메뉴 + 모바일 메뉴 버튼 -->
                <div class="flex items-center space-x-1 md:space-x-4 flex-shrink-0">
                    <!-- 날씨 위젯 -->
                    <div id="mobile-weather" class="md:hidden text-xs"></div>
                    <div id="weather" class="hidden md:block"></div>
                    
                    <!-- 사용자 메뉴 -->
                    {% if user %}
                        <!-- 모바일용 사용자 메뉴 -->
                        <div class="md:hidden relative" id="mobile-user-menu-nav">
                            <button onclick="toggleMobileUserMenuNav()" class="flex items-center space-x-1 px-2 py-1 rounded-lg bg-gradient-to-r from-primary-50 to-secondary-50 hover:from-primary-100 hover:to-secondary-100 border border-primary-200 transition-all duration-300">
                                <div class="w-6 h-6 bg-gradient-to-r from-primary-400 to-secondary-400 rounded-full flex items-center justify-center">
                                    <i class="fas fa-user text-white text-xs"></i>
                                </div>
                                <span class="font-medium text-gray-700 text-sm truncate max-w-20">{{ user }}</span>
                                <i class="fas fa-chevron-down text-gray-500 text-xs transition-transform" id="mobile-user-menu-nav-arrow"></i>
                            </button>
                            
                            <!-- 모바일 사용자 드롭다운 -->
                            <div id="mobile-user-dropdown-nav" class="hidden absolute right-0 top-full mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-lg z-50">
                                <div class="py-2">
                                    <div class="px-3 py-2 border-b border-gray-100">
                                        <p class="text-sm font-medium text-gray-800 truncate">{{ user }}님</p>
                                        <p class="text-xs text-gray-500">환영합니다!</p>
                                    </div>
                                    <a href="{{ url_for('mypage.mypage_views.mypage')}}" class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors">
                                        <i class="fas fa-user-circle text-primary-500 mr-2 text-xs"></i>
                                        마이페이지
                                    </a>
                                    <div class="border-t border-gray-100 mt-1 pt-1">
                                        <a href="{{ url_for('auth.auth_api.logout')}}" class="flex items-center px-3 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors">
                                            <i class="fas fa-sign-out-alt mr-2 text-xs"></i>
                                            로그아웃
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 데스크톱용 사용자 메뉴 -->
                        <div class="hidden md:block relative" id="user-menu">
                            <button onclick="toggleUserMenu()" class="flex items-center space-x-2 px-3 py-2 rounded-lg bg-gradient-to-r from-primary-50 to-secondary-50 hover:from-primary-100 hover:to-secondary-100 border border-primary-200 transition-all duration-300 hover:shadow-md">
                                <div class="w-8 h-8 bg-gradient-to-r from-primary-400 to-secondary-400 rounded-full flex items-center justify-center">
                                    <i class="fas fa-user text-white text-sm"></i>
                                </div>
                                <span class="font-medium text-gray-700">{{ user }}님</span>
                                <i class="fas fa-chevron-down text-gray-500 text-sm transition-transform" id="user-menu-arrow"></i>
                            </button>
                            
                            <!-- 데스크톱 사용자 드롭다운 -->
                            <div id="user-dropdown" class="hidden absolute right-0 top-full mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-50">
                                <div class="py-2">
                                    <div class="px-4 py-2 border-b border-gray-100">
                                        <p class="text-sm font-medium text-gray-800">{{ user }}님</p>
                                        <p class="text-xs text-gray-500">환영합니다!</p>
                                    </div>
                                    <a href="{{ url_for('mypage.mypage_views.mypage')}}" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors">
                                        <i class="fas fa-user-circle text-primary-500 mr-3"></i>
                                        마이페이지
                                    </a>
                                    <div class="border-t border-gray-100 mt-1 pt-1">
                                        <a href="{{ url_for('auth.auth_api.logout')}}" class="flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors">
                                            <i class="fas fa-sign-out-alt mr-3"></i>
                                            로그아웃
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% else %}
                        <a href="{{ url_for('auth.auth_api.kakao_login')}}" class="md:hidden inline-block transition-all duration-300 hover:-translate-y-0.5 hover:shadow-lg">
                            <img src="{{ url_for('static', filename='img/auth/kakao_login_medium.png', v=static_version) }}" 
                                 alt="카카오 로그인" 
                                 class="h-8 w-auto object-contain rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300">
                        </a>
                        <a href="{{ url_for('auth.auth_api.kakao_login')}}" class="hidden md:inline-block transition-all duration-300 hover:-translate-y-0.5 hover:shadow-lg">
                            <img src="{{ url_for('static', filename='img/auth/kakao_login_medium.png', v=static_version) }}" 
                                 alt="카카오 로그인" 
                                 class="h-10 w-auto object-contain rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300">
                        </a>
                    {% endif %}
                    
                    <!-- 모바일 메뉴 버튼 -->
                    <button class="md:hidden p-2 text-gray-700 hover:text-secondary-500 flex-shrink-0" onclick="toggleMobileMenu()">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </nav>

        <!-- 메인 컨테이너 -->
        <div class="min-h-screen">
            {% block content %}
            {% endblock %}
        </div>

        <!-- 푸터 -->
        <footer class="bg-gray-800 text-white mt-8">
            <div class="max-w-7xl mx-auto px-5 py-8">
                <!-- 메인 풋터 콘텐츠 -->
                <div class="flex flex-col md:flex-row justify-between items-center space-y-6 md:space-y-0">
                    <!-- 좌측: 로고와 설명 -->
                    <div class="flex flex-col md:flex-row items-center md:items-start space-y-4 md:space-y-0 md:space-x-6">
                        <div class="flex items-center text-xl font-bold text-secondary-400">
                            <img src="{{ url_for('static', filename='img/my_pet_voice.PNG', v=static_version) }}" 
                                 style="width: 50px; margin-right: 8px;" alt="My Pet's Voice Logo">
                            <span>My Pet's Voice</span>
                        </div>
                        <div class="text-center md:text-left">
                            <p class="text-gray-300 text-sm">반려동물과의 특별한 소통을 위한 AI 플랫폼</p>
                            <p class="text-gray-400 text-xs mt-1">&copy; 2025 MyPet's Voice. All rights reserved.</p>
                        </div>
                    </div>
                    
                    <!-- 우측: 소셜미디어 링크 -->
                    <div class="flex items-center space-x-3">
                        <span class="text-gray-400 text-sm mr-2">Follow us</span>
                        <a href="#" onclick="alert('Instagram 링크 (데모)')" 
                           class="w-9 h-9 bg-gray-700 hover:bg-gradient-to-r hover:from-purple-500 hover:to-pink-500 rounded-full flex items-center justify-center text-white transition-all duration-300 hover:-translate-y-1 hover:shadow-lg">
                            <i class="fab fa-instagram text-sm"></i>
                        </a>
                        <a href="#" onclick="alert('Facebook 링크 (데모)')" 
                           class="w-9 h-9 bg-gray-700 hover:bg-blue-600 rounded-full flex items-center justify-center text-white transition-all duration-300 hover:-translate-y-1 hover:shadow-lg">
                            <i class="fab fa-facebook text-sm"></i>
                        </a>
                        <a href="#" onclick="alert('Twitter 링크 (데모)')" 
                           class="w-9 h-9 bg-gray-700 hover:bg-blue-400 rounded-full flex items-center justify-center text-white transition-all duration-300 hover:-translate-y-1 hover:shadow-lg">
                            <i class="fab fa-twitter text-sm"></i>
                        </a>
                        <a href="#" onclick="alert('YouTube 링크 (데모)')" 
                           class="w-9 h-9 bg-gray-700 hover:bg-red-600 rounded-full flex items-center justify-center text-white transition-all duration-300 hover:-translate-y-1 hover:shadow-lg">
                            <i class="fab fa-youtube text-sm"></i>
                        </a>
                    </div>
                </div>
            </div>
        </footer>
<script src="{{ url_for('static', filename='js/weather.js') }}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // 데스크톱 날씨 위젯 초기화
        const weatherWidget = initWeatherWidget('weather', '서울');
        
        // 모바일 날씨 위젯 초기화
        const mobileWeatherWidget = initWeatherWidget('mobile-weather', '서울');
    });
</script>
    </body>
</html>
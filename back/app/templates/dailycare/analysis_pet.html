{% extends "base.html" %} {% block title %}반려동물의 목소리가 들려 -
건강리포트{% endblock %} {% block content %}
<link rel="stylesheet" href="../../static/css/analysis.css" />

<!-- 건강 상태 분석 페이지 -->
<div id="analysis-page" class="analysis-page">
  <div class="analysis-header">
    <div class="header-content">
      <h2>📊 건강 상태 분석 리포트</h2>

      <!-- 헤더 안의 선택기들 -->
      <div class="header-controls">
        <select id="petSelect" class="header-select">
          <option value="">반려동물을 선택하세요</option>
        </select>
        <select id="periodSelect" class="header-select">
          <option value="7" selected>최근 7일</option>
          <option value="14">최근 14일</option>
          <option value="30">최근 30일</option>
        </select>
      </div>
    </div>
  </div>

  <!-- 펫 선택 영역 -->
  <div class="pet-selector">
    <select id="petSelect">
      <option value="">반려동물을 선택하세요</option>
    </select>
    <select id="periodSelect">
      <option value="7" selected>최근 7일</option>
      <option value="14">최근 14일</option>
      <option value="30">최근 30일</option>
    </select>
  </div>

  <!-- 로딩 및 에러 메시지 -->
  <div id="loadingDiv" class="loading">데이터를 불러오는 중...</div>
  <div id="errorDiv" class="error" style="display: none"></div>

  <div class="analysis-content">
    <!-- 한줄 요약 -->
    <div class="chart-card">
      <div class="chart-header">최근 7일 요약</div>
      <div id="weekSummary" class="summary-blocks">
        <div class="summary-block weight-block">
          <div class="block-header">몸무게</div>
          <div id="weightSummary" class="block-trend">분석 중...</div>
          <div id="weightAvg" class="block-average">평균 계산 중...</div>
        </div>

        <div class="summary-block food-block">
          <div class="block-header">식사량</div>
          <div id="foodSummary" class="block-trend">분석 중...</div>
          <div id="foodAvg" class="block-average">평균 계산 중...</div>
        </div>

        <div class="summary-block water-block">
          <div class="block-header">수분섭취</div>
          <div id="waterSummary" class="block-trend">분석 중...</div>
          <div id="waterAvg" class="block-average">평균 계산 중...</div>
        </div>

        <div class="summary-block exercise-block">
          <div class="block-header">활동량</div>
          <div id="exerciseSummary" class="block-trend">분석 중...</div>
          <div id="exerciseAvg" class="block-average">평균 계산 중...</div>
        </div>
      </div>
    </div>

    <!-- 몸무게 변화 차트 -->
    <div class="chart-card" id="chartSection1" style="display: none">
      <div class="chart-header">📊 몸무게 변화</div>
      <canvas id="weightChart" style="max-height: 200px"></canvas>
    </div>

    <!-- 식사량 차트 -->
    <div class="chart-card" id="chartSection2" style="display: none">
      <div class="chart-header">🍽️ 식사량</div>
      <canvas id="foodChart" style="max-height: 200px"></canvas>
    </div>

    <!-- 수분 섭취량 차트 -->
    <div class="chart-card" id="chartSection3" style="display: none">
      <div class="chart-header">💧 수분 섭취량</div>
      <canvas id="waterChart" style="max-height: 200px"></canvas>
    </div>

    <!-- 활동량 차트 -->
    <div class="chart-card" id="chartSection4" style="display: none">
      <div class="chart-header">🚶 활동량 (산책)</div>
      <canvas id="exerciseChart" style="max-height: 200px"></canvas>
    </div>

    <!-- 약물/영양제 상태 -->
    <div class="chart-card" id="medicationCard" style="display: none">
      <div class="chart-header">💊 복용 관리</div>
      <div id="medicationStatus">
        <p>분석 중...</p>
      </div>
    </div>

    <!-- 약물 없을 때 대체 표시 -->
    <div class="chart-card" id="noMedicationCard" style="display: none">
      <div class="chart-header">✅ 자연 건강</div>
      <p>현재 특별한 약물 복용 없이</p>
      <p>건강을 잘 유지하고 있어요</p>
      <small style="color: #666">👍 자연스러운 건강 관리</small>
    </div>

    <!-- 7일 트렌드 분석 -->
    <div class="chart-card" style="grid-column: 1 / -1">
      <div class="chart-header">📈 최근 7일 트렌드 분석</div>
      <div id="trendAnalysis" class="trend-grid">
        <!-- 동적으로 만듦 -->
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="../../static/js/analysis.js"></script>
{% endblock %}
